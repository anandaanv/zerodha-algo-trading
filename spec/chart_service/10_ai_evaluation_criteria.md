# AI Interpretability Evaluation Criteria

## Overview

This document outlines specific criteria for evaluating the AI interpretability of charts generated by the chart service. These criteria serve as both implementation guidelines and testing benchmarks to ensure charts can be effectively analyzed by AI systems like OpenAI's GPT models.

## Evaluation Categories

### 1. SVG Structure and Semantics

| Criterion | Description | Implementation Requirement | Test Validation |
|-----------|-------------|----------------------------|----------------|
| **Hierarchical Organization** | SVG elements are organized in a logical hierarchy | Use nested `<g>` elements with semantic grouping | Verify DOM structure matches expected pattern |
| **Element Identification** | Chart elements have clear identifiers | Add `id` attributes with descriptive names | Check for presence of IDs following naming convention |
| **Element Classification** | Elements are categorized by type | Add `class` attributes for element types | Verify class attributes match element types |
| **Semantic Grouping** | Related elements are grouped together | Group related elements within `<g>` tags | Test that elements are grouped appropriately |
| **Namespace Consistency** | Consistent use of namespaces | Use consistent namespace declarations | Validate namespace consistency |

### 2. Metadata Content

| Criterion | Description | Implementation Requirement | Test Validation |
|-----------|-------------|----------------------------|----------------|
| **Chart Type Information** | Metadata includes chart type | Add `chartType` field in metadata | Verify presence of chart type in metadata |
| **Instrument Information** | Metadata includes instrument details | Add `instrument` field with symbol, name, etc. | Check instrument details in metadata |
| **Timeframe Information** | Metadata includes time period details | Add `timeframe` and date range information | Verify time information is accurate |
| **Statistical Summary** | Metadata includes key statistics | Add min, max, average, etc. statistics | Validate statistics against raw data |
| **Indicator Parameters** | Metadata includes indicator configuration | Add indicator types and parameters | Check indicator parameters match configuration |

### 3. Data Representation

| Criterion | Description | Implementation Requirement | Test Validation |
|-----------|-------------|----------------------------|----------------|
| **Data Point Attributes** | Data points have explicit values | Add `data-*` attributes with actual values | Verify data attributes match source data |
| **Axis Information** | Axes have clear scale information | Include axis min/max and units in metadata | Check axis information against chart bounds |
| **Temporal Alignment** | Time-based data points align with time axis | Use consistent time formatting and alignment | Validate temporal alignment of data points |
| **Value Precision** | Numeric values have appropriate precision | Use consistent decimal precision for values | Check decimal precision matches requirements |
| **Data Completeness** | All relevant data points are included | Ensure no data is omitted from visualization | Compare data points with source data |

### 4. Visual Clarity

| Criterion | Description | Implementation Requirement | Test Validation |
|-----------|-------------|----------------------------|----------------|
| **Color Contrast** | Colors have sufficient contrast | Use high-contrast color scheme | Measure color contrast ratios |
| **Element Differentiation** | Different elements are visually distinct | Use different styles for different elements | Verify style differences between element types |
| **Text Readability** | Text elements are clear and readable | Use appropriate font sizes and styles | Check text elements for readability |
| **Pattern Recognition** | Patterns are visually emphasized | Highlight patterns with visual cues | Test pattern visibility in rendered chart |
| **Scale Appropriateness** | Chart scale shows important features | Use appropriate scaling for data range | Verify data features are clearly visible |

### 5. Multi-Chart Relationships

| Criterion | Description | Implementation Requirement | Test Validation |
|-----------|-------------|----------------------------|----------------|
| **Chart Identification** | Individual charts in a grid are clearly identified | Add unique IDs and titles for each chart | Verify each chart has unique identifier |
| **Positional Information** | Chart positions in grid are explicit | Include row/column information in metadata | Check position information matches layout |
| **Inter-Chart Relationships** | Relationships between charts are defined | Add relationship metadata between charts | Validate relationship definitions |
| **Consistent Styling** | Charts in a grid have consistent styling | Use consistent styles across all charts | Check style consistency across charts |
| **Temporal Alignment** | Time-based charts are aligned in time | Ensure time axes are aligned across charts | Verify temporal alignment across charts |

## Implementation Checklist

### SVG Generation Requirements

1. **Base Structure**
   - SVG document with proper XML declaration
   - Viewport and dimensions specification
   - Descriptive title element

2. **Metadata Section**
   - Dedicated metadata element or section
   - JSON-formatted data within CDATA block
   - Complete chart information including:
     - Chart type and purpose
     - Data source and timeframe
     - Indicator details
     - Statistical summary

3. **Element Organization**
   - Main chart container group
   - Price panel group
   - Volume panel group (if applicable)
   - Indicator panel groups
   - Axis groups
   - Legend group

4. **Data Point Attributes**
   - Every data point (candle, bar, etc.) should have:
     - Unique ID with timestamp
     - Class indicating type
     - Data attributes with actual values
     - Timestamp in standard format

5. **Indicator Representation**
   - Each indicator should have:
     - Group container with indicator type class
     - Data points with values and timestamps
     - Parameter information in group attributes
     - Visual styling consistent with indicator type

6. **Grid Layout Elements**
   - Grid container with dimensions
   - Cell containers with position information
   - Relationship metadata between charts

## Testing Methodology

### Automated Tests

1. **Structure Validation**
   - Parse SVG as XML document
   - Verify presence of required elements
   - Check hierarchy matches expected pattern
   - Validate element IDs and classes

2. **Data Validation**
   - Extract data values from SVG
   - Compare with source data
   - Verify statistical calculations
   - Check indicator values

3. **Metadata Validation**
   - Parse metadata JSON
   - Validate against schema
   - Verify all required fields are present
   - Check accuracy of metadata values

4. **Visual Validation**
   - Render SVG in headless browser
   - Capture screenshot
   - Compare with reference image
   - Check element visibility and positioning

### AI Interpretation Testing

For comprehensive evaluation, automated tests should be complemented with actual AI interpretation testing:

1. **GPT Model Testing**
   - Submit SVG to GPT model with standard analysis prompts
   - Evaluate ability to extract key information
   - Measure accuracy of pattern recognition
   - Test interpretation of multiple chart types

2. **Human-AI Comparison**
   - Have human experts analyze charts
   - Have AI analyze same charts
   - Compare interpretations for consistency
   - Identify gaps in AI understanding

## Sample Implementation

### Example SVG Structure

```xml
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="800" height="600">
  <title>AAPL Daily Price Chart with Indicators</title>

  <!-- Metadata section -->
  <metadata id="chart-metadata">
    <data id="chart-info">
      <json><![CDATA[
      {
        "chartType": "CANDLESTICK",
        "instrument": {
          "symbol": "AAPL",
          "name": "Apple Inc.",
          "exchange": "NASDAQ"
        },
        "timeframe": {
          "interval": "1D",
          "from": "2023-01-01",
          "to": "2023-03-31"
        },
        "statistics": {
          "open": 130.28,
          "high": 176.15,
          "low": 124.17,
          "close": 164.90,
          "avgVolume": 67823456
        },
        "indicators": [
          {
            "type": "EMA",
            "parameters": { "period": 20 },
            "values": {
              "current": 160.45,
              "previous": 158.32
            }
          },
          {
            "type": "RSI",
            "parameters": { "period": 14 },
            "values": {
              "current": 68.5,
              "previous": 65.3
            }
          }
        ],
        "patterns": [
          {
            "type": "support",
            "price": 150.25,
            "strength": "strong"
          }
        ]
      }
      ]]></json>
    </data>
  </metadata>

  <!-- Main chart area -->
  <g id="chart-container" class="chart">
    <!-- Price panel -->
    <g id="price-panel" class="price-chart">
      <!-- Candlesticks -->
      <g id="candlesticks" class="candlestick-group">
        <g id="candle-20230103" class="candlestick" 
           data-date="2023-01-03" 
           data-open="130.28" 
           data-high="130.90" 
           data-low="124.17" 
           data-close="125.07" 
           data-volume="87212340">
          <!-- Candlestick visual elements -->
        </g>
        <!-- Additional candlesticks -->
      </g>

      <!-- Moving averages -->
      <g id="ema20" class="indicator ema" data-period="20">
        <!-- EMA line points -->
        <path id="ema20-line" class="line" d="M..." />
        <!-- Individual data points with values -->
        <circle class="data-point" cx="100" cy="200" r="0"
                data-date="2023-01-03" data-value="127.35" />
        <!-- Additional data points -->
      </g>

      <!-- Price axis -->
      <g id="price-axis" class="axis y-axis">
        <!-- Axis elements -->
      </g>
    </g>

    <!-- Volume panel -->
    <g id="volume-panel" class="volume-chart">
      <!-- Volume bars -->
      <g id="volume-bars" class="volume-group">
        <!-- Volume bar elements -->
      </g>

      <!-- Volume axis -->
      <g id="volume-axis" class="axis y-axis">
        <!-- Axis elements -->
      </g>
    </g>

    <!-- RSI panel -->
    <g id="rsi-panel" class="indicator-chart rsi">
      <!-- RSI line -->
      <path id="rsi14-line" class="line" d="M..." data-period="14" />

      <!-- Overbought/oversold levels -->
      <line id="rsi-overbought" class="threshold" x1="0" y1="30" x2="800" y2="30" />
      <line id="rsi-oversold" class="threshold" x1="0" y1="70" x2="800" y2="70" />

      <!-- RSI axis -->
      <g id="rsi-axis" class="axis y-axis">
        <!-- Axis elements -->
      </g>
    </g>

    <!-- Time axis (shared) -->
    <g id="time-axis" class="axis x-axis">
      <!-- Axis elements -->
    </g>

    <!-- Legend -->
    <g id="legend" class="legend">
      <!-- Legend elements -->
    </g>
  </g>
</svg>
```

## Conclusion

By adhering to these criteria during implementation and validation, we can ensure that charts generated by the chart service are optimally interpretable by AI systems. This will enhance the value of the visualization tools for both human and AI analysis, providing a foundation for more sophisticated trading insights and decision support.
